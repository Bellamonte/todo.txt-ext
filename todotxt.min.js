var TodoTxt=function(){var r="asc",n="desc",c=/^\s+|\s+$/g,l=/\s+/,a=/^\d{4}$/,e=/^\d{2}$/,v=/^\([A-Z]\)$/,o=/^\s*$/,s=/[^\:]+\:[^\:]/,y=function(t){for(var h,c=function(n){for(var t=0;t<f.length;t++)if(f[t].id()===n.id())return t+1;return 0},l=t.split("\n"),f=[],e={},s=0;s<l.length;s++)(h=l[s],o.test(h))||f.push(u(h,c));return e.render=function(n,t){for(var u=e.items(n,t),i="",r=0;r<u.length;r++)i!==""&&(i+="\n"),i+=u[r].render();return i},e.items=function(t,u){var s=[],h,o,e,l;for(t||(t={}),o=0;o<f.length;o++)h=f[o],p(h,t)&&s.push(h);if(i(u)){for(o=0;o<u.length;o++){if(e=u[o],typeof e=="string"&&(u[o]=e={field:e,direction:r}),!e.field)throw new Error("Invalid sort "+e);if(l=["priority","createdDate","completedDate","isComplete"],l.indexOf(e.field)===-1)throw new Error("Cannot sort by this field: "+e.field);e.direction!==n&&(e.direction=r)}var c=null,a=function(t,i,r){var u=t[r.field](),f=i[r.field]();return function(){if(u===f)return 0;switch(r.field){case"isComplete":return r.direction===n?u?1:-1:u?-1:1;case"createdDate":case"completedDate":return u===null?1:f===null?-1:u.getTime()===f.getTime()?0:r.direction===n?u<f?1:-1:u<f?-1:1;case"priority":return u===null?r.direction===n?-1:1:f===null?r.direction===n?1:-1:r.direction===n?u<f?1:-1:u<f?-1:1;default:throw new Error("Unhandled sort.field "+r.field);}}()},v=function(n,t){var i,r;try{for(i=0;i<u.length;i++)if(r=a(n,t,u[i]),r!==0)return r}catch(f){return c=f,0}return n.lineNumber()<t.lineNumber()?-1:1};if(s.sort(v),c)throw new Error(c);}return s},e.length=f.length,e.removeItem=function(n,t){var r,u,i;for(typeof n.render=="function"&&(n=n.render()),r=[],i=0;i<f.length;i++)r[i]=f[i];for(u=0,i=0;i<r.length;i++)if(r[i].render()===n){if(f.splice(u,1),!t)break}else u++;e.length=f.length},e.addItem=function(n){return typeof n.render=="function"&&(n=n.render()),n=u(n,c),n.createdDate()||n.setCreatedDate(new Date),f.push(n),e.length=f.length,n},e.collections=function(n){for(var u={},e={},o=[],s=[],t,r,h,c,i=0;i<f.length;i++)if(n||!f[i].isComplete()){for(h=f[i].contexts(),c=f[i].projects(),t=0;t<h.length;t++)u[h[t]]=!0;for(t=0;t<c.length;t++)e[c[t]]=!0}for(r in u)u[r]===!0&&o.push(r);for(r in e)e[r]===!0&&s.push(r);return o.sort(),s.sort(),{contexts:o,projects:s}},e},p=function(n,r){var e,s,c,h;for(e in r)if(r.hasOwnProperty(e)){if(!n.hasOwnProperty(e))throw new Error("This property is invalid for query: "+e);var u=r[e],f=n[e](),o="direct";typeof u=="function"?o="function":i(u)&&(o="containsAll");switch(o){case"function":if(!u(f))return!1;break;case"containsAll":if(!i(f))throw new Error("Cannot pass array for non-array property");for(s=0;s<u.length;s++){for(c=!1,h=0;h<f.length;h++)if(u[s]===f[h]){c=!0;break}if(!c)return!1}break;case"direct":if(t(u)&&t(f))return w(u,f);if(u!==f)return!1;break;default:throw new Error("unexpected queryPropType: "+o);}}return!0},u=function(n,r){var y,w,u,p;return!n||o.test(n)?parseValues.makePublic():(n=n.replace(c,""),y=[],n!==""&&(y=n.split(l)),w="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(n){var t=Math.random()*16|0,i=n=="x"?t:t&3|8;return i.toString(16)}),u={},u.render=function(){return y.join(" ")},u.id=function(){return w},u.isComplete=function(){return y.length>0&&y[0]==="x"},u.completedDate=function(){return u.isComplete()?y.length<2?null:p(y[1]):null},u.priority=function(){var n=0,t;return(u.isComplete()&&(n++,u.completedDate()&&n++),y.length<=n)?null:(t=y[n],!v.test(t))?null:t[1]},u.createdDate=function(){var n=0,t;return(u.isComplete()&&n++,u.completedDate()&&n++,u.priority()&&n++,y.length<=n)?null:(t=y[n],p(t))},u.contexts=function(){for(var n,i={},t=0;t<y.length;t++)(n=y[t],n.length<2)||n[0]==="@"&&(i[n]=!0);return h(i,"boolean")},u.projects=function(){for(var n,i={},t=0;t<y.length;t++)(n=y[t],n.length<2)||n[0]==="+"&&(i[n]=!0);return h(i,"boolean")},u.addons=function(){for(var u,o,n={},r=0;r<y.length;r++)if(u=y[r],s.test(u)){var e=u.split(":"),h=e.splice(1),t=e[0],f=h.join(":");n[t]?i(n[t])?n[t].push(f):(o=n[t],n[t]=[o,f]):n[t]=f}return n},u.textTokens=function(){var r=[],n=0,i,t;for(u.isComplete()&&n++,u.completedDate()&&n++,u.priority()&&n++,u.createdDate()&&n++,i=n;i<y.length;i++)(t=y[i],t[0]==="@"||t[0]==="+"||s.test(t))||r.push(t);return r},u.lineNumber=function(){return r(this)},u.completeTask=function(){u.isComplete()||y.splice(0,0,"x",f())},u.uncompleteTask=function(){if(u.isComplete()){var n=1;t(u.completedDate())&&n++;y.splice(0,n)}},u.setCreatedDate=function(n){t(n)||(n=new Date);n=b(n);var i=0,r=u.createdDate()===null;u.priority()&&i++;u.completedDate()&&i++;u.isComplete()&&i++;y.splice(i,r?0:1,f(n))},u.addContext=function(n){var i,t;if(typeof n!="string"||/^\s*$/.test(n))throw new Error("Invalid context: "+n);for(n[0]!=="@"&&(n="@"+n),i=u.contexts(),t=0;t<i.length;t++)if(i[t]===n)return;y.push(n)},u.addProject=function(n){var i,t;if(typeof n!="string"||/^\s*$/.test(n))throw new Error("Invalid project: "+n);for(n[0]!=="+"&&(n="+"+n),i=u.projects(),t=0;t<i.length;t++)if(i[t]===n)return;y.push(n)},u.setAddOn=function(n,i){var r,u,e,s,o;if(typeof n!="string"||/^\s*$/.test(n)||["@","+"].indexOf(n[0])>-1)throw new Error("Invalid addon name: "+n);for(i=t(i)?f(i):i.toString(),u=null,e=[],r=0;r<y.length;r++)s=y[r],s.substr(0,n.length+1)===n+":"&&(u===null?u=r:e.splice(0,0,r));for(r=0;r<e.length;r++)y.splice(e[r],1);o=n+":"+i;u===null?y.push(o):y.splice(u,1,o)},p=function(n){var i=n.split("-"),o,t;if(i.length!==3)return null;var r=i[0],u=i[1],f=i[2],s=a.test(r)&&e.test(u)&&e.test(f);return s?(o=i.join("/"),t=new Date(o),t.toString()==="Invalid Date")?null:(r=parseInt(r,10),u=parseInt(u,10),f=parseInt(f,10),t.getFullYear()!==r)?null:t.getMonth()!==u-1?null:t.getDate()!==f?null:t:null},u)},f=function(n){t(n)||(n=new Date);var i=function(n,t){for(var i=n.toString();i.length<t;)i="0"+i;return i};return n.getFullYear()+"-"+i(n.getMonth()+1,2)+"-"+i(n.getDate(),2)},i=function(n){return Array.isArray?Array.isArray(n):Object.prototype.toString.call(n)==="[object Array]"},t=function(n){return n&&typeof n=="object"&&toString.call(n)=="[object Date]"||!1},w=function(n,t){return n.getFullYear()===t.getFullYear()&&n.getMonth()===t.getMonth()&&n.getDate()===t.getDate()},b=function(n){return new Date(n.getFullYear(),n.getMonth(),n.getDate())},h=function(n,t){var r=[];for(var i in n)n.hasOwnProperty(i)&&(t&&typeof n[i]!==t||r.push(i));return r};return{SORT_ASC:r,SORT_DESC:n,parseFile:y,parseLine:function(n){return u(n,0)}}}();
/*
//# sourceMappingURL=todotxt.min.js.map
*/