var TodoTxt=function(){var i="asc",n="desc",s=/^\s+|\s+$/g,h=/\s+/,c=/^\d{4}$/,f=/^\d{2}$/,l=/^\([A-Z]\)$/,e=/^\s*$/,a=function(u){for(var h,c=u.split("\n"),f=[],o={},s=0;s<c.length;s++)(h=c[s],e.test(h))||f.push(r(h));return o.render=function(n,t){for(var u=o.items(n,t),i="",r=0;r<u.length;r++)i!==""&&(i+="\n"),i+=u[r].render();return i},o.items=function(r,u){var s=[],h,o,e,l;for(r||(r={}),o=0;o<f.length;o++)h=f[o],v(h,r)&&s.push(h);if(t(u)){for(o=0;o<u.length;o++){if(e=u[o],typeof e=="string"&&(u[o]=e={field:e,direction:i}),!e.field)throw new Error("Invalid sort "+e);if(l=["priority","createdDate","completedDate","isComplete"],l.indexOf(e.field)===-1)throw new Error("Cannot sort by this field: "+e.field);e.direction!==n&&(e.direction=i)}var c=null,a=function(t,i,r){var u=t[r.field](),f=i[r.field]();return function(){if(u===f)return 0;switch(r.field){case"isComplete":return r.direction===n?u?1:-1:u?-1:1;case"createdDate":case"completedDate":return u===null?1:f===null?-1:r.direction===n?u<f?1:-1:u<f?-1:1;case"priority":return u===null?r.direction===n?-1:1:f===null?r.direction===n?1:-1:r.direction===n?u<f?1:-1:u<f?-1:1;default:throw new Error("Unhandled sort.field "+r.field);}}()},y=function(n,t){var i,r;try{for(i=0;i<u.length;i++)if(r=a(n,t,u[i]),r!==0)return r}catch(f){c=f}return 0};if(s.sort(y),c)throw new Error(c);}return s},o.length=f.length,o.removeItem=function(n){f=_.reject(f,function(t){return n.id()===t.id()});o.length=f.length},o.addItem=function(n){typeof n=="string"&&(n=r(n));n.createdDate()||n.setCreatedDate(new Date);f.push(n);o.length=f.length},o},v=function(n,i){var e,s,c,h;for(e in i)if(i.hasOwnProperty(e)){if(!n.hasOwnProperty(e))throw new Error("This property is invalid for query: "+e);var r=i[e],f=n[e](),o="direct";typeof r=="function"?o="function":t(r)&&(o="containsAll");switch(o){case"function":if(!r(f))return!1;break;case"containsAll":if(!t(f))throw new Error("Cannot pass array for non-array property");for(s=0;s<r.length;s++){for(c=!1,h=0;h<f.length;h++)if(r[s]===f[h]){c=!0;break}if(!c)return!1}break;case"direct":if(u(r)&&u(f))return y(r,f);if(r!==f)return!1;break;default:throw new Error("unexpected queryPropType: "+o);}}return!0},r=function(n){var i={id:"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(n){var t=Math.random()*16|0,i=n=="x"?t:t&3|8;return i.toString(16)}),priority:null,createdDate:null,isComplete:!1,completedDate:null,contexts:[],projects:[],addons:{},textTokens:[]},y;if((i.makePublic=function(){return{id:function(){return i.id},priority:function(){return i.priority},createdDate:function(){return i.createdDate},isComplete:function(){return i.isComplete},completedDate:function(){return i.completedDate},contexts:function(){return i.contexts},projects:function(){return i.projects},addons:function(){return i.addons},textTokens:function(){return i.textTokens},render:function(){return n},completeTask:function(){i.isComplete||(i.isComplete=!0,i.completedDate=new Date,n="x "+o(i.completedDate)+" "+n)},uncompleteTask:function(){var r,t;i.isComplete&&(i.isComplete=!1,r=i.completedDate!==null,i.completedDate=null,t=n.split(" "),t.splice(0,r?2:1),n=t.join(" "))},setCreatedDate:function(t){var r,f,e;u(t)||(t=new Date);t=p(t);r=0;f=i.createdDate===null;console.log(i.createdDate,f);i.priority&&r++;i.completedDate&&r++;i.isComplete&&r++;e=n.split(" ");e.splice(r,f?0:1,o(t));n=e.join(" ")}}},!n||e.test(n))||(n=n.replace(s,""),n===""))return i.makePublic();var b=n.split(h),a=!0,r=!1,v=!0,w=!0,k=function(n){var i=n.split("-"),o,t;if(i.length!==3)return null;var r=i[0],u=i[1],e=i[2],s=c.test(r)&&f.test(u)&&f.test(e);return s?(o=i.join("/"),t=new Date(o),t.toString()==="Invalid Date")?null:(r=parseInt(r,10),u=parseInt(u,10),e=parseInt(e,10),t.getFullYear()!==r)?null:t.getMonth()!==u-1?null:t.getDate()!==e?null:t:null},d=function(n){var u,s;if(a&&n==="x"){i.isComplete=!0;a=!1;r=!0;return}if(r&&(u=k(n),_.isDate(u))){i.completedDate=u;r=!1;return}if(v&&l.test(n)){i.priority=n[1];a=!1;r=!1;v=!1;return}if(w&&(u=k(n),_.isDate(u))){i.createdDate=u;a=!1;r=!1;v=!1;w=!1;return}if(n.length>1&&n[0]==="@")i.contexts.push(n);else if(n.length>1&&n[0]==="+")i.projects.push(n);else if(n.length>2&&n.indexOf(":")>0&&n.indexOf(":")<n.length-1){var o=n.split(":"),h=o.splice(1),f=o[0],e=h.join(":");i.addons[f]?t(i.addons[f])?i.addons[f].push(e):(s=i.addons[f],i.addons[f]=[s,e]):i.addons[f]=e}else i.textTokens.push(n);v=!1;a=!1;r=!1;w=!1};for(y=0;y<b.length;y++)d(b[y]);return i.makePublic()},o=function(n){var t=function(n,t){for(var i=n.toString();i.length<t;)i="0"+i;return i};return n.getFullYear()+"-"+t(n.getMonth()+1,2)+"-"+t(n.getDate(),2)},t=function(n){return Array.isArray?Array.isArray(n):Object.prototype.toString.call(n)==="[object Array]"},u=function(n){return n&&typeof n=="object"&&toString.call(n)=="[object Date]"||!1},y=function(n,t){return n.getFullYear()===t.getFullYear()&&n.getMonth()===t.getMonth()&&n.getDate()===t.getDate()},p=function(n){return new Date(n.getFullYear(),n.getMonth(),n.getDate())};return{SORT_ASC:i,SORT_DESC:n,parseFile:a,parseLine:r}}();
/*
//# sourceMappingURL=todotxt.min.js.map
*/