var TodoTxt=function(){var r="asc",n="desc",s=/^\s+|\s+$/g,h=/\s+/,c=/^\d{4}$/,f=/^\d{2}$/,l=/^\([A-Z]\)$/,e=/^\s*$/,a=function(t){for(var h,c=function(n){for(var t=0;t<f.length;t++)if(f[t].id()===n.id())return t+1;return 0},l=t.split("\n"),f=[],o={},s=0;s<l.length;s++)(h=l[s],e.test(h))||f.push(u(h,c));return o.render=function(n,t){for(var u=o.items(n,t),i="",r=0;r<u.length;r++)i!==""&&(i+="\n"),i+=u[r].render();return i},o.items=function(t,u){var s=[],h,o,e,l;for(t||(t={}),o=0;o<f.length;o++)h=f[o],v(h,t)&&s.push(h);if(i(u)){for(o=0;o<u.length;o++){if(e=u[o],typeof e=="string"&&(u[o]=e={field:e,direction:r}),!e.field)throw new Error("Invalid sort "+e);if(l=["priority","createdDate","completedDate","isComplete"],l.indexOf(e.field)===-1)throw new Error("Cannot sort by this field: "+e.field);e.direction!==n&&(e.direction=r)}var c=null,a=function(t,i,r){var u=t[r.field](),f=i[r.field]();return function(){if(u===f)return 0;switch(r.field){case"isComplete":return r.direction===n?u?1:-1:u?-1:1;case"createdDate":case"completedDate":return u===null?1:f===null?-1:u.getTime()===f.getTime()?0:r.direction===n?u<f?1:-1:u<f?-1:1;case"priority":return u===null?r.direction===n?-1:1:f===null?r.direction===n?1:-1:r.direction===n?u<f?1:-1:u<f?-1:1;default:throw new Error("Unhandled sort.field "+r.field);}}()},y=function(n,t){var i,r;try{for(i=0;i<u.length;i++)if(r=a(n,t,u[i]),r!==0)return r}catch(f){return c=f,0}return n.lineNumber()<t.lineNumber()?-1:1};if(s.sort(y),c)throw new Error(c);}return s},o.length=f.length,o.removeItem=function(n,t){var r,u,i;for(typeof n.render=="function"&&(n=n.render()),r=[],i=0;i<f.length;i++)r[i]=f[i];for(u=0,i=0;i<r.length;i++)if(r[i].render()===n){if(f.splice(u,1),!t)break}else u++;o.length=f.length},o.addItem=function(n){return typeof n.render=="function"&&(n=n.render()),n=u(n,c),n.createdDate()||n.setCreatedDate(new Date),f.push(n),o.length=f.length,n},o},v=function(n,r){var e,s,c,h;for(e in r)if(r.hasOwnProperty(e)){if(!n.hasOwnProperty(e))throw new Error("This property is invalid for query: "+e);var u=r[e],f=n[e](),o="direct";typeof u=="function"?o="function":i(u)&&(o="containsAll");switch(o){case"function":if(!u(f))return!1;break;case"containsAll":if(!i(f))throw new Error("Cannot pass array for non-array property");for(s=0;s<u.length;s++){for(c=!1,h=0;h<f.length;h++)if(u[s]===f[h]){c=!0;break}if(!c)return!1}break;case"direct":if(t(u)&&t(f))return y(u,f);if(u!==f)return!1;break;default:throw new Error("unexpected queryPropType: "+o);}}return!0},u=function(n,r){var u={id:"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(n){var t=Math.random()*16|0,i=n=="x"?t:t&3|8;return i.toString(16)}),priority:null,createdDate:null,isComplete:!1,completedDate:null,contexts:[],projects:[],addons:{},textTokens:[]},w;if((u.makePublic=function(){return{id:function(){return u.id},priority:function(){return u.priority},createdDate:function(){return u.createdDate},isComplete:function(){return u.isComplete},completedDate:function(){return u.completedDate},contexts:function(){return u.contexts},projects:function(){return u.projects},addons:function(){return u.addons},textTokens:function(){return u.textTokens},lineNumber:function(){return r(this)},render:function(){return n},completeTask:function(){u.isComplete||(u.isComplete=!0,u.completedDate=new Date,n="x "+o(u.completedDate)+" "+n)},uncompleteTask:function(){var i,t;u.isComplete&&(u.isComplete=!1,i=u.completedDate!==null,u.completedDate=null,t=n.split(" "),t.splice(0,i?2:1),n=t.join(" "))},setCreatedDate:function(i){var r,e,f;t(i)||(i=new Date);i=p(i);r=0;e=u.createdDate===null;u.priority&&r++;u.completedDate&&r++;u.isComplete&&r++;f=n.split(" ");f.splice(r,e?0:1,o(i));n=f.join(" ")}}},!n||e.test(n))||(n=n.replace(s,""),n===""))return u.makePublic();var k=n.split(h),v=!0,a=!1,y=!0,b=!0,d=function(n){var i=n.split("-"),o,t;if(i.length!==3)return null;var r=i[0],u=i[1],e=i[2],s=c.test(r)&&f.test(u)&&f.test(e);return s?(o=i.join("/"),t=new Date(o),t.toString()==="Invalid Date")?null:(r=parseInt(r,10),u=parseInt(u,10),e=parseInt(e,10),t.getFullYear()!==r)?null:t.getMonth()!==u-1?null:t.getDate()!==e?null:t:null},g=function(n){var r,s;if(v&&n==="x"){u.isComplete=!0;v=!1;a=!0;return}if(a&&(r=d(n),t(r))){u.completedDate=r;a=!1;return}if(y&&l.test(n)){u.priority=n[1];v=!1;a=!1;y=!1;return}if(b&&(r=d(n),t(r))){u.createdDate=r;v=!1;a=!1;y=!1;b=!1;return}if(n.length>1&&n[0]==="@")u.contexts.push(n);else if(n.length>1&&n[0]==="+")u.projects.push(n);else if(n.length>2&&n.indexOf(":")>0&&n.indexOf(":")<n.length-1){var o=n.split(":"),h=o.splice(1),f=o[0],e=h.join(":");u.addons[f]?i(u.addons[f])?u.addons[f].push(e):(s=u.addons[f],u.addons[f]=[s,e]):u.addons[f]=e}else u.textTokens.push(n);y=!1;v=!1;a=!1;b=!1};for(w=0;w<k.length;w++)g(k[w]);return u.makePublic()},o=function(n){var t=function(n,t){for(var i=n.toString();i.length<t;)i="0"+i;return i};return n.getFullYear()+"-"+t(n.getMonth()+1,2)+"-"+t(n.getDate(),2)},i=function(n){return Array.isArray?Array.isArray(n):Object.prototype.toString.call(n)==="[object Array]"},t=function(n){return n&&typeof n=="object"&&toString.call(n)=="[object Date]"||!1},y=function(n,t){return n.getFullYear()===t.getFullYear()&&n.getMonth()===t.getMonth()&&n.getDate()===t.getDate()},p=function(n){return new Date(n.getFullYear(),n.getMonth(),n.getDate())};return{SORT_ASC:r,SORT_DESC:n,parseFile:a,parseLine:function(n){return u(n,0)}}}();
/*
//# sourceMappingURL=todotxt.min.js.map
*/